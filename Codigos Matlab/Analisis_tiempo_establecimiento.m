clc;
clear;

% === CONFIGURACIÓN ===
step_time = 5;

% === PWM usados en cada experimento (en microsegundos) ===
pwms = [0, 1300, 1300, 1300];

% === PEGAR DATOS AQUÍ ===
% Cada experimento tiene su par de datos: tiempos{i}, angulos{i}

% --- EXPERIMENTO 1 ---
tiempos{1} = [0.000, 0.050, 0.100, 0.150, 0.200, 0.250, 0.300, 0.350, 0.400, 0.450, 0.500, 0.550, 0.600, 0.650, 0.700, 0.750, 0.800, 0.850, 0.900, 0.950, 1.000, 1.050, 1.100, 1.150, 1.200, 1.250, 1.300, 1.350, 1.400, 1.450, 1.500, 1.550, 1.600, 1.650, 1.700, 1.750, 1.800, 1.850, 1.900, 1.950, 2.000, 2.050, 2.100, 2.150, 2.200, 2.250, 2.300, 2.350, 2.400, 2.450, 2.500, 2.550, 2.600, 2.650, 2.700, 2.750, 2.800, 2.850, 2.900, 2.950, 3.000, 3.050, 3.100, 3.150, 3.200, 3.250, 3.300, 3.350, 3.400, 3.450, 3.500, 3.550, 3.600, 3.650, 3.700, 3.750, 3.800, 3.850, 3.900, 3.950, 4.000, 4.050, 4.100, 4.150, 4.200, 4.250, 4.300, 4.350, 4.400, 4.450, 4.500, 4.550, 4.600, 4.650, 4.700, 4.750, 4.800, 4.850, 4.900, 4.950, 5.051, 5.101, 5.151, 5.201, 5.251, 5.301, 5.351, 5.401, 5.451, 5.501, 5.551, 5.601, 5.651, 5.701, 5.751, 5.801, 5.851, 5.901, 5.951, 6.002, 6.051, 6.101, 6.151, 6.201, 6.251, 6.301, 6.351, 6.401, 6.451, 6.501, 6.551, 6.601, 6.651, 6.701, 6.751, 6.801, 6.851, 6.901, 6.951, 7.001, 7.051, 7.101, 7.151, 7.201, 7.251, 7.301, 7.351, 7.401, 7.452, 7.501, 7.551, 7.601, 7.651, 7.701, 7.752, 7.802, 7.852, 7.902, 7.952, 8.002, 8.052, 8.102, 8.152, 8.202, 8.252, 8.302, 8.352, 8.402, 8.452, 8.502, 8.552, 8.602, 8.652, 8.702, 8.752, 8.802, 8.852, 8.903, 8.952, 9.002, 9.052, 9.102, 9.152, 9.203, 9.253, 9.303, 9.353, 9.403, 9.453, 9.503, 9.553, 9.603, 9.653, 9.703, 9.753, 9.803, 9.853, 9.903, 9.953, 10.003, 10.053, 10.103, 10.153, 10.203, 10.253, 10.303, 10.354, 10.403, 10.453, 10.503, 10.553, 10.603, 10.653, 10.703, 10.753, 10.803, 10.853, 10.903, 10.953, 11.003, 11.053, 11.103, 11.153, 11.203, 11.253, 11.303, 11.353, 11.403, 11.453, 11.503, 11.553, 11.603, 11.653, 11.703, 11.753, 11.804, 11.853, 11.903, 11.953, 12.003, 12.053, 12.104, 12.154, 12.204, 12.254, 12.304, 12.354, 12.404, 12.454, 12.504, 12.554, 12.604, 12.654, 12.704, 12.754, 12.804, 12.854, 12.904, 12.954, 13.004, 13.054, 13.104, 13.154, 13.204, 13.255, 13.304, 13.354, 13.404, 13.454, 13.504, 13.555, 13.605, 13.655, 13.705, 13.755, 13.805, 13.855, 13.905, 13.955, 14.005, 14.055, 14.105, 14.155, 14.205, 14.255, 14.305, 14.355, 14.405, 14.455, 14.505, 14.555, 14.605, 14.655, 14.706, 14.755, 14.805, 14.855, 14.905, 14.955, 15.005, 15.055, 15.105, 15.155, 15.205, 15.255, 15.305, 15.355, 15.405, 15.455, 15.505, 15.555, 15.605, 15.655, 15.705, 15.755, 15.805, 15.855, 15.905, 15.955, 16.005, 16.055, 16.105, 16.156, 16.205, 16.255, 16.305, 16.355, 16.405, 16.456, 16.506, 16.556, 16.606, 16.656, 16.706, 16.756, 16.806, 16.856, 16.906, 16.956, 17.006, 17.056, 17.106, 17.156, 17.206, 17.256, 17.306, 17.356, 17.406, 17.456, 17.506, 17.556, 17.607, 17.656, 17.706, 17.756, 17.806, 17.856, 17.907, 17.957, 18.007, 18.057, 18.107, 18.157, 18.207, 18.257, 18.307, 18.357, 18.407, 18.457, 18.507, 18.557, 18.607, 18.657, 18.707, 18.757, 18.807, 18.857, 18.907, 18.957, 19.007, 19.058, 19.107, 19.157, 19.207, 19.257, 19.307, 19.357, 19.407, 19.457, 19.507, 19.557, 19.607, 19.657, 19.707, 19.757, 19.807, 19.857, 19.907, 19.957, 20.007, 20.057, 20.107, 20.157, 20.207, 20.257, 20.307, 20.357, 20.407, 20.457, 20.508, 20.557, 20.607, 20.657, 20.707, 20.757, 20.808, 20.858, 20.908, 20.958, 21.008, 21.058, 21.108, 21.158, 21.208, 21.258, 21.308, 21.358, 21.408, 21.458, 21.508, 21.558, 21.608, 21.658, 21.708, 21.758, 21.808, 21.858, 21.908, 21.959, 22.008, 22.058, 22.108, 22.158, 22.208, 22.259, 22.309, 22.359, 22.409, 22.459, 22.509, 22.559, 22.609, 22.659, 22.709, 22.759, 22.809, 22.859, 22.909, 22.959, 23.009, 23.059, 23.109, 23.159, 23.209, 23.259, 23.309, 23.359, 23.410, 23.459, 23.509, 23.559, 23.609, 23.659, 23.709, 23.759, 23.809, 23.859, 23.909, 23.959, 24.009, 24.059, 24.109, 24.159, 24.209, 24.259, 24.309, 24.359, 24.409, 24.459, 24.509, 24.559, 24.609, 24.659, 24.709, 24.759, 24.809, 24.860, 24.909, 24.959, 25.009
];  % pegá aquí los tiempos del experimento 1
angulos{1} = [-34.15, -37.63, -41.02, -44.07, -46.62, -48.66, -50.26, -51.55, -52.56, -53.39, -54.02, -54.49, -54.84, -55.12, -55.36, -55.58, -55.73, -55.79, -55.78, -55.83, -55.89, -55.89, -55.87, -55.88, -55.88, -55.83, -55.78, -55.82, -55.87, -55.88, -55.89, -55.90, -55.93, -55.95, -55.91, -55.89, -55.88, -55.88, -55.89, -55.85, -55.85, -55.80, -55.88, -55.88, -55.87, -55.89, -55.89, -55.92, -55.96, -55.99, -55.98, -55.98, -55.96, -55.95, -55.89, -55.89, -55.87, -55.85, -55.85, -55.86, -55.88, -55.91, -55.89, -55.93, -55.90, -55.87, -55.81, -55.82, -55.83, -55.81, -55.80, -55.84, -55.83, -55.84, -55.82, -55.83, -55.82, -55.87, -55.91, -55.91, -55.95, -55.98, -56.05, -56.07, -56.05, -56.05, -56.03, -56.04, -56.03, -55.97, -55.94, -55.87, -55.87, -55.88, -55.89, -55.93, -55.93, -55.96, -55.98, -55.92, -55.91, -55.93, -55.98, -56.01, -56.05, -56.07, -56.07, -56.07, -56.03, -56.01, -55.96, -55.94, -55.95, -55.93, -55.96, -56.02, -56.01, -55.98, -55.95, -55.96, -55.94, -55.89, -55.83, -55.83, -55.90, -55.92, -55.91, -55.90, -55.91, -55.89, -55.87, -55.84, -55.84, -55.86, -55.85, -55.89, -55.98, -56.04, -56.07, -56.05, -56.01, -55.97, -55.96, -55.90, -55.85, -55.80, -55.80, -55.82, -55.82, -55.86, -55.88, -55.87, -55.80, -55.80, -55.77, -55.77, -55.80, -55.79, -55.80, -55.83, -55.82, -55.87, -55.91, -55.96, -55.94, -55.92, -55.90, -55.90, -55.93, -55.97, -56.01, -56.03, -56.03, -56.04, -56.10, -56.08, -56.04, -56.03, -56.00, -55.97, -55.98, -55.99, -55.93, -55.94, -55.91, -55.91, -55.92, -55.87, -55.86, -55.84, -55.88, -55.91, -55.95, -55.94, -55.95, -55.97, -55.95, -55.91, -55.90, -55.90, -55.87, -55.85, -55.80, -55.81, -55.85, -55.88, -55.90, -55.94, -55.91, -55.90, -55.95, -55.97, -56.03, -56.07, -56.08, -56.07, -56.07, -56.03, -55.97, -55.97, -55.93, -55.94, -55.97, -55.99, -56.04, -56.07, -56.07, -56.07, -56.03, -56.02, -56.02, -56.03, -56.04, -56.06, -56.05, -56.05, -56.06, -56.07, -56.03, -55.95, -55.91, -55.90, -55.95, -56.00, -56.00, -56.00, -56.01, -55.99, -56.01, -56.01, -56.02, -56.01, -56.07, -56.09, -56.12, -56.16, -56.15, -56.08, -56.10, -56.11, -56.04, -55.96, -55.90, -55.83, -55.78, -55.79, -55.80, -55.82, -55.87, -55.90, -55.90, -55.89, -55.85, -55.86, -55.84, -55.80, -55.76, -55.74, -55.77, -55.79, -55.80, -55.83, -55.87, -55.84, -55.83, -55.83, -55.85, -55.87, -55.88, -55.91, -55.92, -55.96, -55.96, -55.99, -56.05, -56.05, -56.00, -55.97, -55.91, -55.95, -55.95, -55.94, -55.98, -55.96, -55.91, -55.87, -55.84, -55.84, -55.83, -55.90, -55.88, -55.86, -55.86, -55.84, -55.84, -55.85, -55.91, -55.90, -55.90, -55.92, -55.96, -55.95, -55.96, -55.96, -55.95, -55.99, -55.99, -55.95, -55.99, -56.00, -55.95, -55.92, -55.96, -56.02, -56.03, -56.04, -56.03, -56.02, -56.03, -56.04, -56.00, -55.98, -55.93, -55.91, -55.90, -55.92, -55.94, -55.88, -55.90, -55.92, -55.93, -55.97, -56.00, -55.98, -55.97, -55.97, -55.98, -55.99, -56.00, -56.03, -56.00, -56.03, -56.02, -56.01, -56.03, -56.05, -56.06, -56.07, -56.05, -56.01, -55.98, -56.00, -55.99, -55.93, -55.83, -55.83, -55.82, -55.86, -55.83, -55.84, -55.89, -55.90, -55.91, -55.95, -55.96, -55.94, -56.00, -55.94, -55.90, -55.89, -55.87, -55.89, -55.96, -55.98, -55.95, -56.00, -56.00, -55.94, -55.93, -55.91, -55.93, -56.00, -56.02, -55.98, -55.97, -55.99, -56.00, -56.04, -56.02, -56.04, -56.02, -56.01, -56.00, -56.03, -56.01, -56.01, -55.97, -55.98, -56.00, -56.00, -55.99, -55.93, -55.90, -55.89, -55.90, -55.90, -55.90, -55.92, -55.90, -55.93, -55.96, -56.04, -56.06, -56.06, -56.04, -56.07, -56.05, -56.02, -56.02, -56.05, -56.06, -56.05, -56.08, -56.07, -56.07, -56.04, -56.01, -56.05, -56.04, -56.05, -56.13, -56.20, -56.17, -56.12, -56.15, -56.12, -56.10, -56.15, -56.08, -56.04, -55.99, -55.95, -55.94, -55.89, -55.90, -55.94, -55.91, -55.89, -55.87, -55.83, -55.85, -55.85, -55.91, -55.91, -55.89, -55.85, -55.84, -55.90, -55.97, -56.01, -55.98, -55.96, -55.92, -55.92, -55.86, -55.90, -55.97, -56.02, -56.07, -56.11, -56.12, -56.05, -56.01, -56.01, -55.99, -55.97, -55.96, -55.93, -55.91, -55.91
];  % pegá aquí los ángulos del experimento 1

% --- EXPERIMENTO 2 ---
tiempos{2} = [0.000, 0.050, 0.100, 0.150, 0.200, 0.250, 0.300, 0.350, 0.400, 0.450, 0.500, 0.550, 0.600, 0.650, 0.700, 0.750, 0.800, 0.850, 0.900, 0.950, 1.000, 1.050, 1.100, 1.150, 1.200, 1.250, 1.300, 1.350, 1.400, 1.450, 1.500, 1.550, 1.600, 1.650, 1.700, 1.750, 1.800, 1.850, 1.900, 1.950, 2.000, 2.050, 2.100, 2.150, 2.200, 2.250, 2.300, 2.350, 2.400, 2.450, 2.500, 2.550, 2.600, 2.650, 2.700, 2.750, 2.800, 2.850, 2.900, 2.950, 3.000, 3.050, 3.100, 3.150, 3.200, 3.250, 3.300, 3.350, 3.400, 3.450, 3.500, 3.550, 3.600, 3.650, 3.700, 3.750, 3.800, 3.850, 3.900, 3.950, 4.000, 4.050, 4.100, 4.150, 4.200, 4.250, 4.300, 4.350, 4.400, 4.450, 4.500, 4.550, 4.600, 4.650, 4.700, 4.750, 4.800, 4.850, 4.900, 4.950, 5.051, 5.101, 5.151, 5.201, 5.251, 5.301, 5.351, 5.401, 5.452, 5.502, 5.552, 5.602, 5.652, 5.702, 5.752, 5.802, 5.852, 5.902, 5.952, 6.002, 6.052, 6.102, 6.152, 6.202, 6.252, 6.302, 6.352, 6.402, 6.452, 6.502, 6.552, 6.603, 6.652, 6.702, 6.752, 6.802, 6.852, 6.903, 6.953, 7.003, 7.053, 7.103, 7.153, 7.203, 7.253, 7.303, 7.353, 7.403, 7.453, 7.503, 7.553, 7.603, 7.653, 7.703, 7.753, 7.803, 7.853, 7.903, 7.953, 8.003, 8.054, 8.103, 8.153, 8.203, 8.253, 8.303, 8.354, 8.404, 8.454, 8.504, 8.554, 8.604, 8.654, 8.704, 8.754, 8.804, 8.854, 8.904, 8.954, 9.004, 9.054, 9.104, 9.154, 9.204, 9.254, 9.304, 9.354, 9.404, 9.454, 9.505, 9.554, 9.604, 9.654, 9.704, 9.754, 9.804, 9.854, 9.904, 9.954, 10.004, 10.054, 10.104, 10.154, 10.204, 10.254, 10.304, 10.354, 10.404, 10.454, 10.504, 10.554, 10.604, 10.654, 10.704, 10.754, 10.804, 10.854, 10.904, 10.955, 11.004, 11.054, 11.104, 11.154, 11.204, 11.255, 11.305, 11.355, 11.405, 11.455, 11.505, 11.555, 11.605, 11.655, 11.705, 11.755, 11.805, 11.855, 11.905, 11.955, 12.005, 12.055, 12.105, 12.155, 12.205, 12.255, 12.305, 12.355, 12.406, 12.455, 12.505, 12.555, 12.605, 12.655, 12.706, 12.756, 12.806, 12.856, 12.906, 12.956, 13.006, 13.056, 13.106, 13.156, 13.206, 13.256, 13.306, 13.356, 13.406, 13.456, 13.506, 13.556, 13.606, 13.656, 13.706, 13.756, 13.806, 13.857, 13.906, 13.956, 14.006, 14.056, 14.106, 14.156, 14.206, 14.256, 14.306, 14.356, 14.406, 14.456, 14.506, 14.556, 14.606, 14.656, 14.706, 14.756, 14.806, 14.856, 14.906, 14.956, 15.006, 15.056, 15.106, 15.156, 15.206, 15.256, 15.307, 15.356, 15.406, 15.456, 15.506, 15.556, 15.607, 15.657, 15.707, 15.757, 15.807, 15.857, 15.907, 15.957, 16.007, 16.057, 16.107, 16.157, 16.207, 16.257, 16.307, 16.357, 16.407, 16.457, 16.507, 16.557, 16.607, 16.657, 16.707, 16.758, 16.807, 16.857, 16.907, 16.957, 17.007, 17.058, 17.108, 17.158, 17.208, 17.258, 17.308, 17.358, 17.408, 17.458, 17.508, 17.558, 17.608, 17.658, 17.708, 17.758, 17.808, 17.858, 17.908, 17.958, 18.008, 18.058, 18.108, 18.158, 18.209, 18.258, 18.308, 18.358, 18.408, 18.458, 18.508, 18.558, 18.608, 18.658, 18.708, 18.758, 18.808, 18.858, 18.908, 18.958, 19.008, 19.058, 19.108, 19.158, 19.208, 19.258, 19.308, 19.358, 19.408, 19.458, 19.508, 19.558, 19.608, 19.659, 19.708, 19.758, 19.808, 19.858, 19.908, 19.959, 20.009, 20.059, 20.109, 20.159, 20.209, 20.259, 20.309, 20.359, 20.409, 20.459, 20.509, 20.559, 20.609, 20.659, 20.709, 20.759, 20.809, 20.859, 20.909, 20.959, 21.009, 21.059, 21.110, 21.159, 21.209, 21.259, 21.309, 21.359, 21.410, 21.460, 21.510, 21.560, 21.610, 21.660, 21.710, 21.760, 21.810, 21.860, 21.910, 21.960, 22.010, 22.060, 22.110, 22.160, 22.210, 22.260, 22.310, 22.360, 22.410, 22.460, 22.510, 22.561, 22.610, 22.660, 22.710, 22.760, 22.810, 22.860, 22.910, 22.960, 23.010, 23.060, 23.110, 23.160, 23.210, 23.260, 23.310, 23.360, 23.410, 23.460, 23.510, 23.560, 23.610, 23.660, 23.710, 23.760, 23.810, 23.860, 23.910, 23.960, 24.011, 24.060, 24.110, 24.160, 24.210, 24.260, 24.311, 24.361, 24.411, 24.461, 24.511, 24.561, 24.611, 24.661, 24.711, 24.761, 24.811, 24.861, 24.911, 24.961, 25.011
];
angulos{2} = [-1.13, -2.87, -4.93, -7.16, -9.47, -11.81, -14.12, -16.38, -18.57, -20.69, -22.72, -24.66, -26.51, -28.27, -29.94, -31.53, -33.03, -34.44, -35.78, -37.04, -38.23, -39.35, -40.40, -41.40, -42.33, -43.21, -44.03, -44.81, -45.54, -46.22, -46.87, -47.47, -48.04, -48.57, -49.07, -49.54, -49.97, -50.38, -50.76, -51.12, -51.45, -51.77, -52.05, -52.33, -52.58, -52.81, -53.03, -53.24, -53.43, -53.61, -53.77, -53.92, -54.06, -54.19, -54.32, -54.43, -54.53, -54.62, -54.71, -54.79, -54.86, -54.94, -55.00, -55.06, -55.12, -55.18, -55.23, -55.28, -55.32, -55.36, -55.39, -55.43, -55.46, -55.50, -55.53, -55.56, -55.59, -55.62, -55.64, -55.67, -55.69, -55.70, -55.72, -55.73, -55.75, -55.76, -55.77, -55.78, -55.79, -55.80, -55.80, -55.81, -55.82, -55.83, -55.84, -55.85, -55.86, -55.87, -55.87, -55.88, -55.89, -55.80, -55.62, -55.44, -55.45, -55.35, -55.43, -55.35, -55.12, -54.87, -54.80, -54.47, -53.99, -53.67, -53.03, -52.28, -51.50, -50.79, -49.81, -48.64, -47.51, -46.12, -44.66, -43.27, -41.88, -40.22, -38.62, -36.93, -35.04, -33.25, -31.45, -29.48, -27.61, -25.84, -23.90, -22.09, -20.40, -18.52, -16.61, -14.94, -13.22, -11.45, -9.93, -8.26, -6.73, -5.46, -4.21, -2.87, -1.76, -0.53, 0.55, 1.40, 2.37, 3.44, 4.27, 5.14, 5.98, 6.55, 7.13, 7.74, 8.22, 8.59, 9.04, 9.27, 9.34, 9.54, 9.61, 9.46, 9.20, 9.10, 8.88, 8.46, 8.20, 7.83, 7.27, 6.59, 6.11, 5.65, 5.03, 4.56, 4.14, 3.53, 2.74, 2.01, 1.31, 0.43, -0.40, -1.02, -1.68, -2.46, -3.16, -3.66, -4.23, -5.00, -5.67, -6.33, -7.04, -7.90, -8.63, -9.14, -9.72, -10.29, -10.63, -10.94, -11.32, -11.85, -12.25, -12.61, -13.12, -13.60, -13.83, -13.89, -14.05, -14.21, -14.17, -14.15, -14.35, -14.55, -14.64, -14.75, -15.05, -15.34, -15.43, -15.50, -15.76, -16.04, -16.23, -16.21, -16.26, -16.49, -16.50, -16.45, -16.59, -16.92, -17.24, -17.31, -17.53, -17.87, -18.01, -17.97, -17.84, -17.90, -17.87, -17.66, -17.54, -17.63, -17.65, -17.54, -17.48, -17.63, -17.77, -17.67, -17.57, -17.68, -17.81, -17.86, -17.72, -17.61, -17.71, -17.60, -17.45, -17.51, -17.78, -17.97, -17.94, -18.12, -18.28, -18.21, -18.19, -18.29, -18.54, -18.55, -18.64, -18.88, -19.00, -18.92, -18.77, -18.82, -18.71, -18.48, -18.45, -18.53, -18.44, -18.52, -18.80, -19.00, -18.97, -19.06, -19.09, -18.92, -18.88, -19.02, -19.19, -19.13, -19.27, -19.39, -19.27, -19.19, -19.24, -19.43, -19.40, -19.48, -19.70, -19.73, -19.62, -19.67, -19.82, -19.75, -19.61, -19.66, -19.75, -19.60, -19.50, -19.53, -19.69, -19.62, -19.48, -19.51, -19.36, -19.12, -18.91, -18.91, -18.82, -18.76, -18.90, -18.96, -18.82, -18.81, -18.99, -18.96, -18.84, -18.91, -19.05, -18.95, -18.86, -18.98, -19.04, -18.89, -18.79, -18.90, -18.91, -18.74, -18.49, -18.43, -18.48, -18.32, -18.31, -18.45, -18.40, -18.15, -17.95, -17.97, -17.79, -17.61, -17.66, -17.74, -17.62, -17.32, -17.27, -17.25, -17.03, -16.88, -16.95, -17.01, -16.87, -16.81, -16.97, -17.03, -16.92, -17.01, -17.04, -16.91, -16.70, -16.70, -16.80, -16.76, -16.90, -17.12, -17.11, -16.92, -16.88, -16.80, -16.55, -16.49, -16.61, -16.57, -16.33, -16.31, -16.39, -16.25, -16.14, -16.27, -16.34, -16.23, -16.28, -16.47, -16.42, -16.38, -16.56, -16.65, -16.53, -16.40, -16.51, -16.53, -16.60, -16.89, -16.99, -16.98, -16.99, -17.21, -17.18, -17.23, -17.47, -17.43, -17.31, -17.26, -17.24, -17.02, -16.90, -16.99, -16.93, -16.76, -16.82, -16.94, -16.83, -16.80, -17.01, -17.05, -16.95, -16.87, -16.99, -17.03, -16.88, -16.97, -17.00, -16.85, -16.81, -16.94, -17.17, -17.21, -17.38, -17.66, -17.72, -17.68, -17.64, -17.70, -17.55, -17.37, -17.40, -17.49, -17.35, -17.21, -17.28, -17.41, -17.32, -17.23, -17.27, -17.14, -16.93, -16.74, -16.78, -16.84, -16.81, -16.98, -17.25, -17.28, -17.10, -17.04, -16.99, -16.74, -16.60, -16.69, -16.66, -16.44, -16.42, -16.54, -16.45, -16.31, -16.40, -16.49, -16.51, -16.63, -16.94, -17.06, -17.04, -17.21, -17.47, -17.47, -17.28, -17.24, -17.36, -17.28, -17.33, -17.50, -17.44, -17.19, -17.12, -16.98, -16.68, -16.61
];

% --- EXPERIMENTO 3 ---
tiempos{1} = [0.000, 0.050, 0.100, 0.150, 0.200, 0.250, 0.300, 0.350, 0.400, 0.450, 0.500, 0.550, 0.600, 0.650, 0.700, 0.750, 0.800, 0.850, 0.900, 0.950, 1.000, 1.050, 1.100, 1.150, 1.200, 1.250, 1.300, 1.350, 1.400, 1.450, 1.500, 1.550, 1.600, 1.650, 1.700, 1.750, 1.800, 1.850, 1.900, 1.950, 2.000, 2.050, 2.100, 2.150, 2.200, 2.250, 2.300, 2.350, 2.400, 2.450, 2.500, 2.550, 2.600, 2.650, 2.700, 2.750, 2.800, 2.850, 2.900, 2.950, 3.000, 3.050, 3.100, 3.150, 3.200, 3.250, 3.300, 3.350, 3.400, 3.450, 3.500, 3.550, 3.600, 3.650, 3.700, 3.750, 3.800, 3.850, 3.900, 3.950, 4.000, 4.050, 4.100, 4.150, 4.200, 4.250, 4.300, 4.350, 4.400, 4.450, 4.500, 4.550, 4.600, 4.650, 4.700, 4.750, 4.800, 4.850, 4.900, 4.950, 5.051, 5.101, 5.151, 5.201, 5.251, 5.301, 5.351, 5.401, 5.451, 5.501, 5.552, 5.601, 5.651, 5.701, 5.751, 5.801, 5.852, 5.902, 5.952, 6.002, 6.052, 6.102, 6.152, 6.202, 6.252, 6.302, 6.352, 6.402, 6.452, 6.502, 6.552, 6.602, 6.652, 6.702, 6.752, 6.802, 6.852, 6.902, 6.952, 7.003, 7.052, 7.102, 7.152, 7.202, 7.252, 7.302, 7.352, 7.402, 7.452, 7.502, 7.552, 7.602, 7.652, 7.702, 7.752, 7.802, 7.852, 7.902, 7.952, 8.002, 8.052, 8.102, 8.152, 8.202, 8.252, 8.302, 8.352, 8.402, 8.453, 8.502, 8.552, 8.602, 8.652, 8.702, 8.753, 8.803, 8.853, 8.903, 8.953, 9.003, 9.053, 9.103, 9.153, 9.203, 9.253, 9.303, 9.353, 9.403, 9.453, 9.503, 9.553, 9.603, 9.653, 9.703, 9.753, 9.803, 9.853, 9.904, 9.953, 10.003, 10.053, 10.103, 10.153, 10.204, 10.254, 10.304, 10.354, 10.404, 10.454, 10.504, 10.554, 10.604, 10.654, 10.704, 10.754, 10.804, 10.854, 10.904, 10.954, 11.004, 11.054, 11.104, 11.154, 11.204, 11.254, 11.304, 11.355, 11.404, 11.454, 11.504, 11.554, 11.604, 11.654, 11.704, 11.754, 11.804, 11.854, 11.904, 11.954, 12.004, 12.054, 12.104, 12.154, 12.204, 12.254, 12.304, 12.354, 12.404, 12.454, 12.504, 12.554, 12.604, 12.654, 12.704, 12.754, 12.805, 12.854, 12.904, 12.954, 13.004, 13.054, 13.105, 13.155, 13.205, 13.255, 13.305, 13.355, 13.405, 13.455, 13.505, 13.555, 13.605, 13.655, 13.705, 13.755, 13.805, 13.855, 13.905, 13.955, 14.005, 14.055, 14.105, 14.155, 14.205, 14.256, 14.305, 14.355, 14.405, 14.455, 14.505, 14.556, 14.606, 14.656, 14.706, 14.756, 14.806, 14.856, 14.906, 14.956, 15.006, 15.056, 15.106, 15.156, 15.206, 15.256, 15.306, 15.356, 15.406, 15.456, 15.506, 15.556, 15.606, 15.656, 15.707, 15.756, 15.806, 15.856, 15.906, 15.956, 16.006, 16.056, 16.106, 16.156, 16.206, 16.256, 16.306, 16.356, 16.406, 16.456, 16.506, 16.556, 16.606, 16.656, 16.706, 16.756, 16.806, 16.856, 16.906, 16.956, 17.006, 17.056, 17.106, 17.157, 17.206, 17.256, 17.306, 17.356, 17.406, 17.457, 17.507, 17.557, 17.607, 17.657, 17.707, 17.757, 17.807, 17.857, 17.907, 17.957, 18.007, 18.057, 18.107, 18.157, 18.207, 18.257, 18.307, 18.357, 18.407, 18.457, 18.507, 18.557, 18.608, 18.657, 18.707, 18.757, 18.807, 18.857, 18.908, 18.958, 19.008, 19.058, 19.108, 19.158, 19.208, 19.258, 19.308, 19.358, 19.408, 19.458, 19.508, 19.558, 19.608, 19.658, 19.708, 19.758, 19.808, 19.858, 19.908, 19.958, 20.008, 20.059, 20.108, 20.158, 20.208, 20.258, 20.308, 20.358, 20.408, 20.458, 20.508, 20.558, 20.608, 20.658, 20.708, 20.758, 20.808, 20.858, 20.908, 20.958, 21.008, 21.058, 21.108, 21.158, 21.208, 21.258, 21.308, 21.358, 21.408, 21.458, 21.509, 21.558, 21.608, 21.658, 21.708, 21.758, 21.809, 21.859, 21.909, 21.959, 22.009, 22.059, 22.109, 22.159, 22.209, 22.259, 22.309, 22.359, 22.409, 22.459, 22.509, 22.559, 22.609, 22.659, 22.709, 22.759, 22.809, 22.859, 22.909, 22.960, 23.009, 23.059, 23.109, 23.159, 23.209, 23.260, 23.310, 23.360, 23.410, 23.460, 23.510, 23.560, 23.610, 23.660, 23.710, 23.760, 23.810, 23.860, 23.910, 23.960, 24.010, 24.060, 24.110, 24.160, 24.210, 24.260, 24.310, 24.360, 24.411, 24.460, 24.510, 24.560, 24.610, 24.660, 24.710, 24.760, 24.810, 24.860, 24.910, 24.960, 25.010
];
angulos{1} = [-2.83, -6.83, -11.19, -15.52, -19.63, -23.42, -26.86, -29.95, -32.70, -35.14, -37.31, -39.23, -40.94, -42.45, -43.79, -44.97, -46.02, -46.95, -47.79, -48.54, -49.21, -49.82, -50.37, -50.86, -51.30, -51.71, -52.09, -52.43, -52.73, -53.00, -53.25, -53.48, -53.69, -53.86, -54.03, -54.18, -54.32, -54.45, -54.56, -54.67, -54.78, -54.87, -54.96, -55.03, -55.10, -55.17, -55.24, -55.30, -55.37, -55.42, -55.47, -55.51, -55.55, -55.58, -55.62, -55.65, -55.68, -55.71, -55.73, -55.76, -55.78, -55.80, -55.83, -55.85, -55.86, -55.87, -55.88, -55.89, -55.89, -55.89, -55.89, -55.90, -55.90, -55.91, -55.92, -55.92, -55.93, -55.93, -55.93, -55.93, -55.93, -55.93, -55.94, -55.95, -55.94, -55.93, -55.93, -55.93, -55.92, -55.92, -55.92, -55.93, -55.92, -55.91, -55.91, -55.90, -55.90, -55.89, -55.89, -55.88, -55.79, -55.94, -55.94, -55.75, -55.29, -55.28, -54.87, -54.75, -54.99, -54.73, -53.95, -53.73, -52.89, -51.63, -50.83, -50.06, -48.81, -47.03, -45.53, -44.16, -42.11, -40.07, -38.08, -35.77, -33.24, -31.14, -29.03, -26.49, -24.48, -22.08, -19.27, -16.90, -15.08, -12.80, -11.06, -9.55, -7.58, -5.60, -4.24, -2.82, -1.68, -1.03, 0.14, 1.19, 1.70, 2.52, 3.51, 3.88, 4.30, 5.09, 5.28, 5.92, 6.83, 7.10, 7.08, 7.46, 7.35, 7.53, 7.64, 7.27, 6.54, 6.34, 5.70, 5.36, 5.07, 4.14, 3.63, 3.55, 2.82, 2.53, 2.01, 0.91, 0.37, -0.35, -1.69, -2.68, -3.37, -4.68, -5.44, -6.06, -6.84, -7.17, -7.59, -8.58, -8.95, -9.41, -9.77, -9.77, -10.02, -10.67, -10.71, -11.03, -11.12, -11.00, -11.54, -11.72, -11.39, -11.52, -11.34, -11.07, -11.48, -11.47, -11.40, -11.79, -12.41, -12.39, -12.78, -13.37, -13.31, -13.86, -14.59, -14.64, -15.04, -15.63, -15.53, -16.03, -16.10, -15.89, -15.98, -16.39, -16.15, -16.53, -16.58, -16.32, -16.69, -17.33, -17.22, -17.69, -17.82, -17.57, -17.96, -18.00, -17.65, -17.95, -17.95, -17.61, -17.92, -17.89, -18.05, -18.50, -18.66, -18.31, -18.50, -18.67, -18.67, -19.21, -19.20, -18.62, -18.44, -18.63, -18.43, -18.77, -18.89, -18.54, -18.28, -18.61, -18.32, -18.36, -18.74, -18.51, -18.24, -18.30, -18.73, -18.56, -18.29, -18.59, -18.65, -18.70, -19.21, -19.86, -19.78, -19.65, -20.00, -19.72, -19.60, -19.95, -20.40, -20.18, -19.96, -19.90, -19.29, -18.88, -19.02, -19.41, -19.13, -19.31, -19.64, -19.33, -19.07, -19.34, -19.89, -19.84, -19.55, -19.73, -20.07, -19.81, -19.97, -20.42, -20.83, -20.63, -20.33, -20.58, -20.30, -19.81, -19.84, -20.33, -20.56, -20.20, -20.39, -20.51, -20.06, -19.76, -19.84, -20.26, -20.09, -20.20, -20.67, -20.61, -20.18, -20.29, -20.61, -20.32, -19.94, -20.09, -20.29, -20.14, -20.36, -20.95, -21.34, -21.08, -21.01, -20.88, -20.25, -20.02, -20.34, -20.60, -20.23, -20.40, -20.50, -20.02, -19.82, -20.09, -20.28, -20.32, -20.85, -20.94, -20.57, -20.70, -20.95, -20.88, -20.37, -20.33, -20.55, -20.15, -20.28, -20.60, -20.64, -20.20, -20.19, -20.47, -20.28, -20.50, -20.85, -20.92, -20.47, -20.45, -20.16, -19.49, -19.34, -19.55, -19.21, -18.44, -18.35, -18.36, -17.85, -17.56, -17.85, -17.82, -17.31, -16.81, -16.96, -17.00, -16.57, -16.75, -16.67, -16.11, -15.57, -15.71, -15.75, -15.75, -16.35, -16.66, -16.48, -16.19, -16.50, -16.24, -15.89, -16.20, -16.42, -16.10, -15.59, -15.65, -15.33, -14.87, -15.10, -15.45, -15.48, -15.66, -16.33, -16.56, -16.34, -16.69, -16.58, -16.23, -16.47, -17.19, -17.49, -17.30, -17.66, -17.71, -17.30, -17.30, -17.78, -18.29, -18.38, -18.84, -19.45, -19.38, -19.17, -19.13, -19.18, -18.67, -18.32, -18.51, -18.45, -17.96, -17.34, -17.39, -17.60, -17.25, -17.03, -17.06, -16.60, -16.26, -16.39, -16.90, -16.81, -17.09, -17.67, -17.65, -17.38, -17.20, -17.58, -17.33, -17.04, -17.27, -17.54, -17.21, -16.59, -16.63, -16.60, -16.13, -15.94, -16.27, -16.33, -15.93, -15.36, -15.33, -15.65, -15.44, -15.65, -16.23, -16.29, -15.83, -15.45, -15.70, -15.45, -15.05, -15.26, -15.68, -15.99, -15.77, -16.13, -16.61, -16.47, -16.32, -16.72, -17.45, -17.48, -17.58, -18.14, -18.31, -17.98, -18.26, -18.34, -17.95, -17.43, -17.56, -17.74, -17.69
];

% --- EXPERIMENTO 4 ---
tiempos{2} = [0.000, 0.050, 0.100, 0.150, 0.200, 0.250, 0.300, 0.350, 0.400, 0.450, 0.500, 0.550, 0.600, 0.650, 0.700, 0.750, 0.800, 0.850, 0.900, 0.950, 1.000, 1.050, 1.100, 1.150, 1.200, 1.250, 1.300, 1.350, 1.400, 1.450, 1.500, 1.550, 1.600, 1.650, 1.700, 1.750, 1.800, 1.850, 1.900, 1.950, 2.000, 2.050, 2.100, 2.150, 2.200, 2.250, 2.300, 2.350, 2.400, 2.450, 2.500, 2.550, 2.600, 2.650, 2.700, 2.750, 2.800, 2.850, 2.900, 2.950, 3.000, 3.050, 3.100, 3.150, 3.200, 3.250, 3.300, 3.350, 3.400, 3.450, 3.500, 3.550, 3.600, 3.650, 3.700, 3.750, 3.800, 3.850, 3.900, 3.950, 4.000, 4.050, 4.100, 4.150, 4.200, 4.250, 4.300, 4.350, 4.400, 4.450, 4.500, 4.550, 4.600, 4.650, 4.700, 4.750, 4.800, 4.850, 4.900, 4.950, 5.051, 5.101, 5.151, 5.201, 5.251, 5.301, 5.351, 5.401, 5.451, 5.501, 5.551, 5.601, 5.651, 5.701, 5.751, 5.801, 5.851, 5.901, 5.951, 6.001, 6.051, 6.101, 6.151, 6.201, 6.251, 6.301, 6.352, 6.401, 6.451, 6.501, 6.551, 6.601, 6.652, 6.702, 6.752, 6.802, 6.852, 6.902, 6.952, 7.002, 7.052, 7.102, 7.152, 7.202, 7.252, 7.302, 7.352, 7.402, 7.452, 7.502, 7.552, 7.602, 7.652, 7.702, 7.752, 7.803, 7.852, 7.902, 7.952, 8.002, 8.052, 8.102, 8.152, 8.202, 8.252, 8.302, 8.352, 8.402, 8.452, 8.502, 8.552, 8.602, 8.652, 8.702, 8.752, 8.802, 8.852, 8.902, 8.952, 9.002, 9.052, 9.102, 9.152, 9.202, 9.253, 9.302, 9.352, 9.402, 9.452, 9.502, 9.553, 9.603, 9.653, 9.703, 9.753, 9.803, 9.853, 9.903, 9.953, 10.003, 10.053, 10.103, 10.153, 10.203, 10.253, 10.303, 10.353, 10.403, 10.453, 10.503, 10.553, 10.603, 10.653, 10.704, 10.753, 10.803, 10.853, 10.903, 10.953, 11.004, 11.054, 11.104, 11.154, 11.204, 11.254, 11.304, 11.354, 11.404, 11.454, 11.504, 11.554, 11.604, 11.654, 11.704, 11.754, 11.804, 11.854, 11.904, 11.954, 12.004, 12.054, 12.104, 12.155, 12.204, 12.254, 12.304, 12.354, 12.404, 12.454, 12.504, 12.554, 12.604, 12.654, 12.704, 12.754, 12.804, 12.854, 12.904, 12.954, 13.004, 13.054, 13.104, 13.154, 13.204, 13.254, 13.304, 13.354, 13.404, 13.454, 13.504, 13.554, 13.605, 13.654, 13.704, 13.754, 13.804, 13.854, 13.905, 13.955, 14.005, 14.055, 14.105, 14.155, 14.205, 14.255, 14.305, 14.355, 14.405, 14.455, 14.505, 14.555, 14.605, 14.655, 14.705, 14.755, 14.805, 14.855, 14.905, 14.955, 15.005, 15.056, 15.105, 15.155, 15.205, 15.255, 15.305, 15.356, 15.406, 15.456, 15.506, 15.556, 15.606, 15.656, 15.706, 15.756, 15.806, 15.856, 15.906, 15.956, 16.006, 16.056, 16.106, 16.156, 16.206, 16.256, 16.306, 16.356, 16.406, 16.456, 16.507, 16.556, 16.606, 16.656, 16.706, 16.756, 16.806, 16.856, 16.906, 16.956, 17.006, 17.056, 17.106, 17.156, 17.206, 17.256, 17.306, 17.356, 17.406, 17.456, 17.506, 17.556, 17.606, 17.656, 17.706, 17.756, 17.806, 17.856, 17.906, 17.957, 18.006, 18.056, 18.106, 18.156, 18.206, 18.257, 18.307, 18.357, 18.407, 18.457, 18.507, 18.557, 18.607, 18.657, 18.707, 18.757, 18.807, 18.857, 18.907, 18.957, 19.007, 19.057, 19.107, 19.157, 19.207, 19.257, 19.307, 19.357, 19.408, 19.457, 19.507, 19.557, 19.607, 19.657, 19.708, 19.758, 19.808, 19.858, 19.908, 19.958, 20.008, 20.058, 20.108, 20.158, 20.208, 20.258, 20.308, 20.358, 20.408, 20.458, 20.508, 20.558, 20.608, 20.658, 20.708, 20.758, 20.808, 20.859, 20.908, 20.958, 21.008, 21.058, 21.108, 21.158, 21.208, 21.258, 21.308, 21.358, 21.408, 21.458, 21.508, 21.558, 21.608, 21.658, 21.708, 21.758, 21.808, 21.858, 21.908, 21.958, 22.008, 22.058, 22.108, 22.158, 22.208, 22.258, 22.309, 22.358, 22.408, 22.458, 22.508, 22.558, 22.609, 22.659, 22.709, 22.759, 22.809, 22.859, 22.909, 22.959, 23.009, 23.059, 23.109, 23.159, 23.209, 23.259, 23.309, 23.359, 23.409, 23.459, 23.509, 23.559, 23.609, 23.659, 23.709, 23.760, 23.809, 23.859, 23.909, 23.959, 24.009, 24.060, 24.110, 24.160, 24.210, 24.260, 24.310, 24.360, 24.410, 24.460, 24.510, 24.560, 24.610, 24.660, 24.710, 24.760, 24.810, 24.860, 24.910, 24.960, 25.010
];
angulos{2} = [-1.42, -3.56, -6.07, -8.75, -11.48, -14.19, -16.83, -19.38, -21.82, -24.14, -26.33, -28.39, -30.33, -32.15, -33.85, -35.45, -36.93, -38.31, -39.60, -40.80, -41.91, -42.95, -43.91, -44.80, -45.63, -46.39, -47.10, -47.75, -48.37, -48.94, -49.46, -49.95, -50.40, -50.82, -51.21, -51.57, -51.91, -52.22, -52.50, -52.77, -53.01, -53.24, -53.45, -53.64, -53.82, -53.98, -54.13, -54.27, -54.40, -54.51, -54.62, -54.72, -54.82, -54.91, -54.99, -55.08, -55.15, -55.22, -55.28, -55.34, -55.40, -55.45, -55.50, -55.54, -55.57, -55.60, -55.64, -55.67, -55.69, -55.72, -55.74, -55.75, -55.77, -55.78, -55.80, -55.82, -55.83, -55.85, -55.86, -55.87, -55.87, -55.88, -55.88, -55.89, -55.89, -55.89, -55.90, -55.90, -55.90, -55.89, -55.89, -55.89, -55.88, -55.88, -55.88, -55.88, -55.89, -55.89, -55.89, -55.90, -55.86, -56.02, -56.10, -56.05, -55.94, -55.74, -55.74, -55.71, -55.40, -55.32, -55.15, -54.66, -54.12, -53.76, -53.14, -52.18, -51.23, -50.39, -49.23, -47.83, -46.50, -44.94, -43.07, -41.16, -39.44, -37.56, -35.46, -33.56, -31.48, -29.30, -27.24, -25.41, -23.42, -21.34, -19.52, -17.85, -15.94, -13.91, -12.22, -10.47, -8.66, -7.14, -5.87, -4.42, -3.10, -2.12, -1.10, 0.02, 0.59, 0.97, 1.49, 1.93, 2.10, 2.36, 2.77, 2.94, 3.19, 3.52, 3.57, 3.34, 3.18, 2.94, 2.44, 2.10, 1.89, 1.40, 0.64, 0.16, -0.33, -1.09, -1.74, -2.19, -2.87, -3.72, -4.30, -4.86, -5.73, -6.54, -7.10, -7.97, -8.72, -9.23, -9.67, -10.40, -11.08, -11.68, -12.54, -13.26, -13.73, -14.05, -14.64, -15.24, -15.53, -15.84, -16.40, -17.04, -17.42, -17.96, -18.55, -18.78, -18.94, -19.35, -19.64, -19.64, -19.75, -20.02, -20.00, -19.86, -19.90, -19.65, -19.20, -19.00, -18.96, -18.65, -18.64, -18.59, -18.28, -17.92, -17.89, -17.79, -17.49, -17.49, -17.58, -17.39, -17.06, -17.02, -16.76, -16.46, -16.49, -16.46, -16.22, -16.30, -16.52, -16.44, -16.47, -16.73, -16.71, -16.87, -17.18, -17.42, -17.38, -17.53, -17.84, -17.91, -18.23, -18.55, -18.62, -18.52, -18.60, -18.40, -18.20, -18.29, -18.21, -17.87, -17.83, -17.85, -17.60, -17.48, -17.62, -17.52, -17.61, -17.95, -18.22, -18.19, -18.32, -18.61, -18.65, -18.87, -19.30, -19.63, -19.66, -19.76, -19.82, -19.61, -19.47, -19.50, -19.69, -19.62, -19.43, -19.46, -19.62, -19.49, -19.12, -19.05, -19.09, -18.85, -18.61, -18.64, -18.69, -18.62, -18.55, -18.77, -18.92, -18.79, -18.73, -18.70, -18.42, -17.97, -17.77, -17.81, -17.63, -17.65, -17.88, -17.85, -17.58, -17.37, -17.47, -17.48, -17.28, -17.21, -17.40, -17.43, -17.27, -17.28, -17.50, -17.49, -17.36, -17.46, -17.42, -17.17, -16.85, -16.79, -16.92, -16.79, -16.85, -17.13, -17.48, -17.52, -17.49, -17.72, -17.70, -17.54, -17.64, -17.83, -17.92, -17.98, -18.29, -18.54, -18.52, -18.56, -18.84, -18.92, -18.78, -18.83, -19.07, -19.02, -18.87, -18.94, -19.04, -18.87, -18.78, -18.97, -19.02, -19.07, -19.37, -19.57, -19.52, -19.31, -19.37, -19.26, -18.96, -18.88, -18.98, -19.14, -19.01, -18.82, -18.87, -19.00, -18.85, -18.64, -18.69, -18.84, -18.72, -18.55, -18.66, -18.82, -18.80, -18.71, -18.83, -19.05, -19.00, -18.87, -18.97, -18.89, -18.64, -18.34, -18.31, -18.42, -18.29, -18.34, -18.61, -18.69, -18.51, -18.25, -18.28, -18.41, -18.25, -18.04, -18.11, -18.21, -18.04, -17.91, -18.06, -18.09, -17.89, -18.00, -18.30, -18.30, -18.23, -18.45, -18.59, -18.69, -19.02, -19.16, -18.98, -18.82, -18.96, -18.79, -18.74, -18.92, -18.84, -18.51, -18.50, -18.45, -18.16, -18.08, -18.22, -18.08, -17.93, -18.09, -18.15, -17.97, -17.97, -18.19, -18.13, -18.21, -18.47, -18.81, -18.81, -18.81, -18.92, -18.75, -18.59, -18.57, -18.77, -18.72, -18.79, -19.05, -19.05, -18.91, -18.83, -19.00, -19.02, -18.83, -18.86, -19.04, -18.91, -18.82, -19.00, -19.02, -18.84, -18.92, -19.05, -19.03, -19.25, -19.65, -19.73, -19.68, -19.89, -19.80, -19.64, -19.77, -20.12, -20.15, -20.07, -20.15, -19.93, -19.75, -19.83, -20.01, -19.86, -19.76, -19.90, -19.82, -19.57, -19.56, -19.34, -18.88, -18.51, -18.48, -18.33, -18.02, -18.02, -17.85, -17.45, -17.06, -16.98, -16.90, -16.79, -16.98
];



% ---------- AJUSTA AQUÍ --------------------------------------------------
ventanaSG     = 21;      % ventana (impar) Savitzky–Golay
ordenSG       = 3;       % orden del polinomio SG (≤ ventanaSG-1)
porcentajeTol = 0.02;    % 5 %  → banda ±5 %
fraccionFinal = 0.04;    % y_inf = promedio del último 10 %
% ------------------------------------------------------------------------

Nexp   = numel(tiempos);                 % nº de experimentos
nFilas = ceil(sqrt(Nexp));               % cuadrícula ~ cuadrada
nCols  = ceil(Nexp/nFilas);

figure('Name','Análisis de T_{ss}','Units','normalized',...
       'Position',[.05 .05 .9 .85]);
tiledlayout(nFilas,nCols,'Padding','compact','TileSpacing','compact')

% === Cortar primeros 5 segundos de todos los experimentos ===
for i = 1:Nexp
    t_i = tiempos{i};
    y_i = angulos{i};
    
    idx_corte = find(t_i >= 5, 1);  % primer índice con t >= 5 s
    tiempos{i} = t_i(idx_corte:end);
    angulos{i} = y_i(idx_corte:end);
end


for n = 1:Nexp
    t = tiempos{n}(:);          % columnas
    y = angulos{n}(:);
    L = numel(y);
    
    % --- Suavizado SG ----------------------------------------------------
    win = min(ventanaSG, L - mod(L-1,2));           % fuerza impar ≤ L
    if win < ordenSG+2,  win = ordenSG+2+mod(ordenSG,2);  end
    y_suav = sgolayfilt(y, ordenSG, win);
    idxSS = t >= step_time + 8;           % ejemplo: >1 s tras el escalón
    y_suav(idxSS) = movmean(y_suav(idxSS), 51, 'Endpoints','shrink');
    
    % --- y_∞ y banda ±5 % -----------------------------------------------
    idxInf = L - round(fraccionFinal*L) + 1 : L;
    yInf   = mean(y_suav(idxInf));
    banda  = porcentajeTol * abs(yInf);
    dentro = abs(y_suav - yInf) <= banda;
    
    % --- Tss -------------------------------------------------------------
    idxLastOut = find(~dentro, 1, 'last');
    if isempty(idxLastOut)               % nunca salió
        Tss = t(1);
    elseif idxLastOut == L               % nunca volvió
        Tss = NaN;
    else
        Tss = t(idxLastOut+1);
    end
    
    % --- SUBPLOT ---------------------------------------------------------
    nexttile;
    hold on; box on; grid on;
        %plot(t,y,':','LineWidth',0.8,'DisplayName','bruta');
        plot(t,y_suav,'-','LineWidth',1.6,'DisplayName','datos');
        yline(yInf + banda,'--k','DisplayName','banda ±2 %');
        yline(yInf - banda,'--k','HandleVisibility','off');
        if ~isnan(Tss)
            xline(Tss,'-r','LineWidth',1.4,...
                  'DisplayName',sprintf('T_{ss}=%.2f s',Tss));
        end
    hold off
    title(sprintf('Exp. %d',n));
    xlabel('t [s]');  ylabel('\theta [°]');
    legend('Location','best')
    
    % --- Consola ---------------------------------------------------------
    if isnan(Tss)
        fprintf('Exp. %d  →  NO alcanzó la banda ±5%%\n',n);
    else
        fprintf('Exp. %d  →  Tss = %.3f s\n',n,Tss);
    end
end