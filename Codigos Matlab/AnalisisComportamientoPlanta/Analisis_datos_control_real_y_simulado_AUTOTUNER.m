clc;
close all;

tiempo = cell(1,1);
angulo = cell(1,1);
pwm    = cell(1,1);
error  = cell(1,1);
tiempo{1} = [0.367, 0.608, 0.908, 1.207, 1.507, 1.806, 2.106, 2.405, 2.705, 3.004, 3.304, 3.603, 3.903, 4.202, 4.502, 4.801, 5.101, 5.400, 5.700, 6.008, 6.308, 6.607, 6.907, 7.206, 7.507, 7.806, 8.106, 8.405, 8.705, 9.004, 9.304, 9.603, 9.903, 10.202, 10.502, 10.801, 11.101, 11.400, 11.700, 12.008, 12.308, 12.607, 12.907, 13.206, 13.506, 13.805, 14.105, 14.404, 14.704, 15.003, 15.303, 15.602, 15.902, 16.201, 16.501, 16.800, 17.100, 17.410, 17.709, 18.009, 18.308, 18.608, 18.907, 19.207, 19.506, 19.806, 20.105, 20.405, 20.704, 21.004, 21.303, 21.603, 21.902, 22.202, 22.501, 22.801, 23.100, 23.400, 23.708, 24.008, 24.307, 24.607, 24.906, 25.206, 25.505, 25.805, 26.104, 26.404, 26.703, 27.003, 27.302, 27.603, 27.902, 28.202, 28.501, 28.801, 29.100, 29.400, 29.708, 30.008, 30.307, 30.607, 30.906, 31.206, 31.505, 31.805, 32.104, 32.404, 32.703, 33.003, 33.302, 33.602, 33.901, 34.201, 34.500, 34.800, 35.109, 35.408, 35.709, 36.008, 36.308, 36.607, 36.907, 37.206, 37.506, 37.805, 38.105, 38.404, 38.704, 39.003, 39.303, 39.602, 39.902, 40.201, 40.501, 40.800, 41.100, 41.408, 41.708, 42.007, 42.307, 42.606, 42.906, 43.205, 43.505, 43.804, 44.104, 44.403, 44.703, 45.002, 45.302, 45.601, 45.901, 46.200, 46.500, 46.809, 47.109, 47.408, 47.708, 48.007, 48.307, 48.606, 48.906, 49.205, 49.505, 49.804, 50.104, 50.403, 50.703, 51.002, 51.302, 51.601, 51.901, 52.200, 52.500, 52.808, 53.108, 53.407, 53.707, 54.006, 54.306, 54.605, 54.905, 55.204, 55.504, 55.803, 56.104, 56.403, 56.703, 57.002, 57.302, 57.601, 57.901, 58.200, 58.500, 58.809, 59.108, 59.408, 59.707, 60.007, 60.306, 60.606, 60.905, 61.205, 61.504, 61.804, 62.103, 62.403, 62.702, 63.002, 63.301, 63.601, 63.900, 64.200, 64.509, 64.809, 65.108, 65.408, 65.707, 66.007, 66.306, 66.606, 66.905, 67.205, 67.504, 67.804, 68.103, 68.403, 68.702, 69.002, 69.301, 69.601, 69.900, 70.200, 70.508, 70.808, 71.107, 71.407, 71.706, 72.006, 72.305, 72.605, 72.904, 73.204, 73.503, 73.803, 74.102, 74.402, 74.701, 75.001, 75.300, 75.600, 75.910, 76.200, 76.509, 76.808, 77.108, 77.407, 77.707, 78.006, 78.306, 78.605, 78.905, 79.204, 79.504, 79.803];
angulo{1} = [0.15, 0.15, 0.00, 0.15, 0.15, 0.15, 0.30, 0.75, 5.70, 11.10, 14.40, 16.20, 17.85, 19.65, 21.30, 22.65, 23.55, 24.15, 24.60, 24.90, 24.90, 25.05, 25.05, 25.05, 25.05, 24.90, 24.90, 24.90, 24.90, 24.75, 24.75, 24.60, 24.60, 24.45, 24.45, 24.30, 24.15, 24.00, 23.85, 23.55, 23.10, 22.65, 22.20, 21.90, 21.30, 20.70, 20.10, 19.35, 18.30, 17.40, 16.35, 15.30, 13.80, 12.90, 12.45, 11.70, 10.50, 9.90, 9.30, 8.55, 7.80, 7.20, 6.60, 5.85, 5.40, 5.40, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.55, 5.55, 5.55, 5.55, 5.55, 5.55, 5.55, 5.70, 5.70, 5.70, 5.85, 5.85, 6.00, 6.00, 6.15, 6.30, 6.30, 6.30, 6.30, 6.45, 6.45, 6.60, 6.75, 7.05, 7.35, 7.65, 7.80, 7.95, 8.10, 8.10, 8.10, 8.25, 8.25, 8.25, 8.40, 8.55, 8.70, 8.85, 8.85, 9.00, 9.30, 9.60, 9.75, 9.90, 9.90, 9.90, 10.05, 10.05, 10.05, 10.20, 10.35, 10.50, 10.50, 10.50, 10.65, 10.65, 10.65, 10.80, 10.80, 10.65, 10.80, 10.80, 10.80, 10.80, 10.80, 10.95, 10.95, 11.10, 11.10, 11.25, 11.25, 11.40, 11.40, 11.40, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.25, 11.25, 11.25, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 10.95, 10.95, 10.95, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95];
pwm{1} = [1362.0, 1362.3, 1368.5, 1365.3, 1370.1, 1368.9, 1369.0, 1359.9, 1318.2, 1305.7, 1314.9, 1321.7, 1314.8, 1308.1, 1303.4, 1302.3, 1303.1, 1299.8, 1297.1, 1295.2, 1295.7, 1292.7, 1290.5, 1288.0, 1285.6, 1283.7, 1281.0, 1278.5, 1276.1, 1274.5, 1271.5, 1271.3, 1267.1, 1266.0, 1262.6, 1261.3, 1259.7, 1257.3, 1255.2, 1255.1, 1257.2, 1256.4, 1255.4, 1250.9, 1252.8, 1253.0, 1252.5, 1253.9, 1258.6, 1256.5, 1258.5, 1260.0, 1267.7, 1264.1, 1262.2, 1266.0, 1271.7, 1266.6, 1268.0, 1270.6, 1273.1, 1275.6, 1277.3, 1281.0, 1278.9, 1276.5, 1278.0, 1278.3, 1279.0, 1279.8, 1280.6, 1281.4, 1282.2, 1282.9, 1283.7, 1284.5, 1285.3, 1286.1, 1286.9, 1287.7, 1288.5, 1289.2, 1289.1, 1290.4, 1291.2, 1291.9, 1292.7, 1293.5, 1294.2, 1295.0, 1295.8, 1295.9, 1296.8, 1297.6, 1298.3, 1299.1, 1299.8, 1300.6, 1298.9, 1301.6, 1302.4, 1302.5, 1303.4, 1303.4, 1304.4, 1304.4, 1302.4, 1305.5, 1306.2, 1306.8, 1305.8, 1306.4, 1307.0, 1307.4, 1306.0, 1306.1, 1304.0, 1306.1, 1306.8, 1306.7, 1307.6, 1308.0, 1307.4, 1308.2, 1308.5, 1307.7, 1307.5, 1307.8, 1307.7, 1308.2, 1307.8, 1303.7, 1303.8, 1306.1, 1306.1, 1306.3, 1306.3, 1305.6, 1305.9, 1305.9, 1305.0, 1303.9, 1302.8, 1304.6, 1304.6, 1303.4, 1304.0, 1303.9, 1303.1, 1303.3, 1305.6, 1302.2, 1302.9, 1302.8, 1302.7, 1302.5, 1301.8, 1301.8, 1301.1, 1301.1, 1300.2, 1300.4, 1299.6, 1299.6, 1299.3, 1295.7, 1298.4, 1298.2, 1298.0, 1297.7, 1297.5, 1297.2, 1296.9, 1296.7, 1296.4, 1296.2, 1295.9, 1295.7, 1295.4, 1295.1, 1294.9, 1294.6, 1294.4, 1294.8, 1294.3, 1294.0, 1293.8, 1293.5, 1293.3, 1293.1, 1292.8, 1292.6, 1292.4, 1292.1, 1291.9, 1291.7, 1291.4, 1291.2, 1291.0, 1290.7, 1288.1, 1288.0, 1290.0, 1289.8, 1289.6, 1289.4, 1289.1, 1288.9, 1289.7, 1288.9, 1288.6, 1289.3, 1288.6, 1288.4, 1288.2, 1288.0, 1287.9, 1287.7, 1287.5, 1287.3, 1287.1, 1286.9, 1286.8, 1286.6, 1286.4, 1286.2, 1290.1, 1286.4, 1286.1, 1284.8, 1282.8, 1282.3, 1284.9, 1284.8, 1284.7, 1284.5, 1284.3, 1284.1, 1283.9, 1283.8, 1283.6, 1283.4, 1283.2, 1283.0, 1282.8, 1282.7, 1282.5, 1282.3, 1282.1, 1281.9, 1281.7, 1281.6, 1281.4, 1281.2, 1281.6, 1281.2, 1281.1, 1280.9, 1280.8, 1280.6, 1280.4, 1280.3, 1280.1, 1280.0, 1279.8, 1279.6];
error{1} = [0.17, 0.17, 0.17, 0.17, 0.17, 0.17, 0.17, 0.16, 0.08, -0.02, -0.08, -0.11, -0.14, -0.17, -0.20, -0.22, -0.24, -0.25, -0.25, -0.26, -0.26, -0.26, -0.26, -0.26, -0.26, -0.26, -0.26, -0.26, -0.26, -0.26, -0.26, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.24, -0.24, -0.24, -0.23, -0.22, -0.21, -0.21, -0.20, -0.19, -0.18, -0.16, -0.14, -0.13, -0.11, -0.09, -0.07, -0.05, -0.04, -0.03, -0.01, 0.00, 0.01, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.07, 0.07, 0.07, 0.07, 0.07, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.05, 0.05, 0.04, 0.04, 0.04, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.02, 0.02, 0.02, 0.02, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, -0.00, -0.00, -0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02];

tiempo{2} = [0.368, 0.600, 0.906, 1.205, 1.505, 1.804, 2.104, 2.403, 2.703, 3.000, 3.306, 3.604, 3.903, 4.201, 4.507, 4.805, 5.104, 5.402, 5.701, 6.007, 6.306, 6.604, 6.903, 7.201, 7.500, 7.805, 8.104, 8.402, 8.701, 9.006, 9.305, 9.603, 9.902, 10.200, 10.506, 10.804, 11.103, 11.401, 11.700, 12.005, 12.304, 12.602, 12.901, 13.206, 13.505, 13.803, 14.103, 14.402, 14.702, 15.001, 15.301, 15.600, 15.900, 16.206, 16.500, 16.805, 17.105, 17.404, 17.704, 18.003, 18.303, 18.602, 18.902, 19.201, 19.501, 19.800, 20.100, 20.405, 20.705, 21.004, 21.304, 21.603, 21.903, 22.202, 22.502, 22.801, 23.101, 23.400, 23.700, 24.006, 24.305, 24.605, 24.904, 25.205, 25.504, 25.804, 26.103, 26.403, 26.702, 27.002, 27.301, 27.601, 27.900, 28.200, 28.505, 28.805, 29.104, 29.404, 29.703, 30.003, 30.300, 30.606, 30.904, 31.203, 31.501, 31.800, 32.105, 32.404, 32.702, 33.001, 33.306, 33.605, 33.903, 34.202, 34.500, 34.807, 35.105, 35.404, 35.702, 36.001, 36.306, 36.605, 36.903, 37.202, 37.500, 37.806, 38.104, 38.403, 38.701, 39.000, 39.305, 39.604, 39.902, 40.201, 40.506, 40.805, 41.103, 41.402, 41.700, 42.006, 42.305, 42.603, 42.901, 43.200, 43.506, 43.804, 44.103, 44.401, 44.708, 45.006, 45.305, 45.603, 45.902, 46.200, 46.506, 46.804, 47.103, 47.401, 47.700, 48.005, 48.304, 48.602, 48.901, 49.206, 49.501, 49.800, 50.100, 50.405, 50.705, 51.004, 51.304, 51.603, 51.903, 52.202, 52.502, 52.801, 53.101, 53.400, 53.700, 54.006, 54.306, 54.605, 54.905, 55.204, 55.504, 55.803, 56.103, 56.402, 56.702, 57.001, 57.301, 57.600, 57.900, 58.205, 58.505, 58.804, 59.104, 59.403, 59.703, 60.002, 60.302, 60.601, 60.901, 61.200, 61.500, 61.805, 62.105, 62.404, 62.704, 63.003, 63.303, 63.602, 63.903, 64.202, 64.502, 64.801, 65.101, 65.400, 65.700, 66.006, 66.305, 66.605, 66.904, 67.204, 67.503, 67.803, 68.102, 68.402, 68.701, 69.001, 69.300, 69.600, 69.905, 70.205, 70.504, 70.804, 71.103, 71.403, 71.702, 72.002, 72.301, 72.601, 72.900, 73.200, 73.506, 73.806, 74.105, 74.405, 74.704, 75.004, 75.303, 75.603, 75.902, 76.202, 76.501, 76.801, 77.100, 77.400, 77.705, 78.005, 78.304, 78.604, 78.903, 79.203, 79.502, 79.802];
angulo{2} = [0.45, 0.30, 0.15, 0.15, 0.15, 0.00, 0.00, -0.15, 7.35, 14.70, 18.90, 21.15, 22.50, 23.70, 24.60, 25.35, 25.50, 25.50, 25.50, 25.50, 25.50, 25.50, 25.50, 25.35, 25.35, 25.20, 25.05, 24.90, 24.90, 24.75, 24.60, 24.45, 24.15, 23.55, 22.65, 21.75, 20.85, 20.10, 19.35, 18.30, 17.10, 15.60, 13.80, 12.15, 10.95, 10.05, 9.00, 7.95, 6.90, 6.15, 5.55, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.40, 5.55, 5.55, 5.55, 5.55, 5.55, 5.70, 5.70, 5.70, 5.85, 6.00, 6.15, 6.30, 6.45, 6.60, 6.90, 7.20, 7.35, 7.50, 7.65, 7.95, 8.10, 8.25, 8.55, 8.85, 9.00, 9.30, 9.45, 9.60, 9.90, 10.20, 10.50, 10.95, 11.40, 11.70, 11.70, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 11.85, 12.00, 11.85, 11.85, 11.70, 11.70, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.55, 11.40, 11.40, 11.40, 11.40, 11.25, 11.10, 10.95, 10.65, 10.50, 10.20, 10.05, 9.75, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.45, 9.30, 9.30, 9.30, 9.30, 9.30, 9.30, 9.30, 9.30, 9.30, 9.30, 9.45, 9.45, 9.45, 9.45, 9.60, 9.60, 9.45, 9.45, 9.45, 9.45, 9.45, 9.45, 9.45, 9.45, 9.45, 9.45, 9.45, 9.45, 9.45, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.75, 9.75, 9.75, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.60, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.60, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.60, 9.60, 9.60, 9.60, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75, 9.75];
pwm{2} = [1363.6, 1360.9, 1366.3, 1365.4, 1367.8, 1372.2, 1373.2, 1373.6, 1313.8, 1298.0, 1310.4, 1310.4, 1310.9, 1304.8, 1300.2, 1298.0, 1298.6, 1295.6, 1292.3, 1288.9, 1285.6, 1282.4, 1279.1, 1277.0, 1272.9, 1271.1, 1269.8, 1266.8, 1261.1, 1258.9, 1256.1, 1253.2, 1251.7, 1254.5, 1254.8, 1252.0, 1251.5, 1250.5, 1250.9, 1253.4, 1254.9, 1261.1, 1265.3, 1267.7, 1268.7, 1268.8, 1271.9, 1272.8, 1276.8, 1277.8, 1277.3, 1277.0, 1277.9, 1279.1, 1280.3, 1281.5, 1282.6, 1283.8, 1285.0, 1286.2, 1287.4, 1287.9, 1289.3, 1290.4, 1291.6, 1292.7, 1293.9, 1295.0, 1296.2, 1297.3, 1298.5, 1298.8, 1300.4, 1301.5, 1302.6, 1303.7, 1303.5, 1305.5, 1306.5, 1307.2, 1307.6, 1308.0, 1309.0, 1309.5, 1310.1, 1309.1, 1308.1, 1310.1, 1310.8, 1311.0, 1307.8, 1310.7, 1311.1, 1308.3, 1308.3, 1310.2, 1308.0, 1307.9, 1308.8, 1308.3, 1307.5, 1306.2, 1302.2, 1301.7, 1300.2, 1303.4, 1302.1, 1302.4, 1302.0, 1301.6, 1301.2, 1300.8, 1300.4, 1300.0, 1300.1, 1299.2, 1298.8, 1298.4, 1298.0, 1297.6, 1297.2, 1296.8, 1296.5, 1296.1, 1295.7, 1295.3, 1294.9, 1294.5, 1294.1, 1293.7, 1293.3, 1292.9, 1292.5, 1292.1, 1291.7, 1291.3, 1289.8, 1290.6, 1290.1, 1290.8, 1289.7, 1289.9, 1289.4, 1289.1, 1288.7, 1288.4, 1288.1, 1287.8, 1287.4, 1287.1, 1286.8, 1286.4, 1286.1, 1288.6, 1288.8, 1285.6, 1285.2, 1287.8, 1286.3, 1285.9, 1287.4, 1286.7, 1289.6, 1287.6, 1288.9, 1289.4, 1289.4, 1288.6, 1288.7, 1288.8, 1288.9, 1289.0, 1289.9, 1290.5, 1290.1, 1290.3, 1290.4, 1290.6, 1290.8, 1291.0, 1291.2, 1291.3, 1291.5, 1291.2, 1291.4, 1291.6, 1291.7, 1291.4, 1290.7, 1292.1, 1292.2, 1292.3, 1292.5, 1292.6, 1292.7, 1292.9, 1293.0, 1293.1, 1293.3, 1293.4, 1293.6, 1296.8, 1293.1, 1293.5, 1293.6, 1293.7, 1293.8, 1293.9, 1294.0, 1293.5, 1293.0, 1291.5, 1294.4, 1294.5, 1294.6, 1294.7, 1294.8, 1294.9, 1295.0, 1295.1, 1295.2, 1295.3, 1295.4, 1294.6, 1295.2, 1295.2, 1295.3, 1295.4, 1295.4, 1295.5, 1295.5, 1295.6, 1295.7, 1295.7, 1296.4, 1292.8, 1295.9, 1296.0, 1296.1, 1296.1, 1296.2, 1295.1, 1296.8, 1296.8, 1296.9, 1297.0, 1296.5, 1296.4, 1296.9, 1297.0, 1297.0, 1297.1, 1297.1, 1297.2, 1297.3, 1297.3, 1297.4, 1297.5, 1297.5, 1297.6, 1297.6, 1297.7, 1297.8, 1297.8, 1297.9, 1298.0];
error{2} = [0.17, 0.17, 0.17, 0.17, 0.17, 0.17, 0.17, 0.18, 0.05, -0.08, -0.16, -0.19, -0.22, -0.24, -0.25, -0.27, -0.27, -0.27, -0.27, -0.27, -0.27, -0.27, -0.27, -0.27, -0.27, -0.27, -0.26, -0.26, -0.26, -0.26, -0.25, -0.25, -0.25, -0.24, -0.22, -0.20, -0.19, -0.18, -0.16, -0.14, -0.12, -0.10, -0.07, -0.04, -0.02, -0.00, 0.02, 0.04, 0.05, 0.07, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.08, 0.07, 0.07, 0.07, 0.06, 0.06, 0.06, 0.05, 0.05, 0.05, 0.04, 0.04, 0.04, 0.03, 0.03, 0.03, 0.02, 0.02, 0.01, 0.01, 0.01, 0.00, -0.00, -0.01, -0.02, -0.02, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.03, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.00, -0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.01, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00];
%
tiempo{3} = [0.354, 0.605, 0.904, 1.204, 1.503, 1.803, 2.102, 2.402, 2.701, 3.002, 3.300, 3.606, 3.904, 4.203, 4.501, 4.800, 5.105, 5.404, 5.702, 6.001, 6.306, 6.605, 6.903, 7.202, 7.500, 7.807, 8.104, 8.403, 8.701, 9.000, 9.306, 9.605, 9.903, 10.202, 10.500, 10.806, 11.104, 11.403, 11.701, 12.000, 12.305, 12.604, 12.902, 13.201, 13.506, 13.805, 14.103, 14.402, 14.700, 15.006, 15.304, 15.602, 15.901, 16.201, 16.500, 16.800, 17.105, 17.405, 17.704, 18.005, 18.304, 18.604, 18.903, 19.203, 19.502, 19.802, 20.101, 20.401, 20.700, 21.000, 21.306, 21.605, 21.905, 22.204, 22.504, 22.803, 23.103, 23.402, 23.702, 24.001, 24.301, 24.600, 24.900, 25.205, 25.505, 25.804, 26.104, 26.403, 26.703, 27.002, 27.302, 27.601, 27.901, 28.200, 28.501, 28.800, 29.100, 29.405, 29.705, 30.004, 30.304, 30.603, 30.903, 31.202, 31.502, 31.801, 32.101, 32.400, 32.700, 33.005, 33.305, 33.602, 33.901, 34.206, 34.505, 34.803, 35.102, 35.400, 35.706, 36.004, 36.303, 36.601, 36.900, 37.206, 37.505, 37.803, 38.102, 38.400, 38.706, 39.004, 39.303, 39.601, 39.900, 40.205, 40.504, 40.802, 41.101, 41.407, 41.705, 42.004, 42.302, 42.600, 42.906, 43.205, 43.503, 43.802, 44.100, 44.406, 44.704, 45.003, 45.301, 45.600, 45.905, 46.204, 46.502, 46.801, 47.107, 47.406, 47.704, 48.003, 48.301, 48.600, 48.905, 49.204, 49.502, 49.801, 50.106, 50.405, 50.703, 51.002, 51.300, 51.606, 51.904, 52.203, 52.501, 52.800, 53.105, 53.404, 53.702, 54.001, 54.306, 54.605, 54.903, 55.202, 55.500, 55.807, 56.104, 56.403, 56.701, 57.000, 57.306, 57.605, 57.903, 58.202, 58.500, 58.806, 59.104, 59.403, 59.701, 60.000, 60.305, 60.604, 60.902, 61.201, 61.507, 61.805, 62.103, 62.402, 62.700, 63.006, 63.305, 63.603, 63.902, 64.200, 64.506, 64.804, 65.103, 65.401, 65.708, 66.006, 66.305, 66.603, 66.902, 67.200, 67.506, 67.804, 68.103, 68.401, 68.700, 69.005, 69.304, 69.602, 69.901, 70.206, 70.505, 70.803, 71.102, 71.400, 71.706, 72.004, 72.303, 72.601, 72.900, 73.205, 73.504, 73.802, 74.101, 74.406, 74.705, 75.003, 75.302, 75.600, 75.907, 76.205, 76.504, 76.802, 77.101, 77.406, 77.705, 78.003, 78.302, 78.600, 78.906, 79.204, 79.503, 79.801];
angulo{3} = [0.60, 0.30, 0.15, 0.00, -0.15, -0.15, -0.45, 0.00, 6.45, 12.45, 16.50, 18.30, 19.65, 21.00, 21.90, 22.35, 22.65, 22.95, 23.10, 23.10, 23.10, 22.95, 22.95, 22.95, 22.95, 22.80, 22.80, 22.65, 22.65, 22.50, 22.20, 22.05, 21.75, 21.30, 20.85, 20.40, 19.80, 19.35, 18.60, 17.70, 16.65, 15.45, 14.10, 13.20, 12.90, 12.45, 11.85, 11.10, 10.35, 10.20, 10.05, 9.90, 9.75, 9.30, 8.70, 7.95, 7.35, 7.05, 6.90, 6.75, 6.60, 6.60, 6.45, 6.45, 6.45, 6.45, 6.45, 6.45, 6.45, 6.45, 6.45, 6.60, 6.60, 6.60, 6.60, 6.60, 6.60, 6.60, 6.60, 6.60, 6.60, 6.60, 6.60, 6.60, 6.75, 6.75, 6.75, 6.75, 6.75, 6.75, 6.75, 6.90, 6.90, 7.05, 7.05, 7.20, 7.35, 7.50, 7.65, 7.80, 8.10, 8.25, 8.40, 8.55, 8.70, 8.85, 9.00, 9.30, 9.45, 9.60, 9.90, 10.20, 10.50, 10.65, 10.65, 10.80, 10.95, 10.95, 10.95, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.40, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.40, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.25, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 11.10, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.95, 10.80, 10.80, 10.80, 10.80, 10.80, 10.80, 10.80, 10.80, 10.80, 10.80, 10.80, 10.80, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.65, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50, 10.50];
pwm{3} = [1349.7, 1354.2, 1356.2, 1359.0, 1360.7, 1362.8, 1367.1, 1359.9, 1318.0, 1305.9, 1306.8, 1315.2, 1310.1, 1305.5, 1305.5, 1303.7, 1301.2, 1297.6, 1294.7, 1292.5, 1289.7, 1288.7, 1284.5, 1281.7, 1279.0, 1277.7, 1273.8, 1274.8, 1268.8, 1266.8, 1266.2, 1262.7, 1261.4, 1262.2, 1261.2, 1258.3, 1260.9, 1258.1, 1260.2, 1261.9, 1262.0, 1263.9, 1266.9, 1265.8, 1262.0, 1264.4, 1267.3, 1267.9, 1269.3, 1267.0, 1268.1, 1268.3, 1267.3, 1270.2, 1272.7, 1275.2, 1278.0, 1278.8, 1278.1, 1277.7, 1278.9, 1279.4, 1280.8, 1281.5, 1282.4, 1283.2, 1284.1, 1285.0, 1285.9, 1286.8, 1287.7, 1286.8, 1289.0, 1289.9, 1290.7, 1291.6, 1292.4, 1293.3, 1294.1, 1294.9, 1295.8, 1296.6, 1297.5, 1298.3, 1296.5, 1299.6, 1300.4, 1301.2, 1302.0, 1302.8, 1303.6, 1301.8, 1304.8, 1302.8, 1306.0, 1306.3, 1304.6, 1304.5, 1306.6, 1307.0, 1303.8, 1306.8, 1307.1, 1307.0, 1306.4, 1306.9, 1307.1, 1303.5, 1305.3, 1306.0, 1304.0, 1302.8, 1301.5, 1302.0, 1303.7, 1303.1, 1302.5, 1302.5, 1302.3, 1299.4, 1299.0, 1301.2, 1301.0, 1300.8, 1300.6, 1300.3, 1298.9, 1299.4, 1299.2, 1298.9, 1298.7, 1298.4, 1298.1, 1297.4, 1297.2, 1296.9, 1296.6, 1296.3, 1296.0, 1295.7, 1295.4, 1296.1, 1295.2, 1294.9, 1294.6, 1294.4, 1294.1, 1291.3, 1294.2, 1293.3, 1293.0, 1292.7, 1292.5, 1292.2, 1292.0, 1291.7, 1291.4, 1291.2, 1290.9, 1290.6, 1290.4, 1290.1, 1289.8, 1289.6, 1289.3, 1289.0, 1288.8, 1288.5, 1288.2, 1288.0, 1287.7, 1287.4, 1290.9, 1290.2, 1287.1, 1286.8, 1286.6, 1286.3, 1286.1, 1285.9, 1285.6, 1285.4, 1285.2, 1284.9, 1284.7, 1284.5, 1284.2, 1284.0, 1285.0, 1283.9, 1283.7, 1283.5, 1283.3, 1283.1, 1282.9, 1282.7, 1282.5, 1282.3, 1282.1, 1281.9, 1281.7, 1281.5, 1281.3, 1281.1, 1280.9, 1280.7, 1280.5, 1280.3, 1280.1, 1279.8, 1279.6, 1279.4, 1279.9, 1279.4, 1279.3, 1279.1, 1278.9, 1278.8, 1278.6, 1278.4, 1278.3, 1278.1, 1277.9, 1277.7, 1278.0, 1277.8, 1277.7, 1277.5, 1277.4, 1277.3, 1277.1, 1277.0, 1276.8, 1276.7, 1276.6, 1276.4, 1276.3, 1276.1, 1276.0, 1275.9, 1275.7, 1275.6, 1275.4, 1275.3, 1275.2, 1275.0, 1274.9, 1274.7, 1274.6, 1274.5, 1272.7, 1271.3, 1274.8, 1274.3, 1274.2, 1274.1, 1274.0, 1273.9, 1273.8, 1273.7, 1273.6, 1273.5, 1273.4, 1273.3, 1273.2, 1273.1];
error{3} = [0.16, 0.17, 0.17, 0.17, 0.18, 0.18, 0.18, 0.17, 0.06, -0.04, -0.11, -0.14, -0.17, -0.19, -0.21, -0.22, -0.22, -0.23, -0.23, -0.23, -0.23, -0.23, -0.23, -0.23, -0.23, -0.22, -0.22, -0.22, -0.22, -0.22, -0.21, -0.21, -0.20, -0.20, -0.19, -0.18, -0.17, -0.16, -0.15, -0.13, -0.12, -0.10, -0.07, -0.06, -0.05, -0.04, -0.03, -0.02, -0.01, -0.00, -0.00, 0.00, 0.00, 0.01, 0.02, 0.04, 0.05, 0.05, 0.05, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.06, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.04, 0.04, 0.04, 0.03, 0.03, 0.03, 0.03, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 0.00, -0.00, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01, -0.01];
%

% === Parámetro de recorte en segundos ===
recorte_inicio = 2.3;  % segundos a recortar desde el inicio

% === Número de experimentos reales definidos ===
n_experimentos = numel(tiempo);

% === Recortar y desplazar tiempo en cada experimento ===
for i = 1:n_experimentos
    indices_validos = tiempo{i} >= recorte_inicio;

    tiempo{i} = tiempo{i}(indices_validos) - recorte_inicio;
    angulo{i} = angulo{i}(indices_validos);
    pwm{i}    = pwm{i}(indices_validos);
    error{i}  = error{i}(indices_validos);
end


% === Cargar archivo generado desde Simulink (MUX con 3 señales) ===
s = load('datos_simulacion_control.mat');
ts = struct2cell(s); ts = ts{1};  % Extrae la estructura simout

tiempo_sim = ts.Time;
datos_sim = ts.Data;


angulo_sim = datos_sim(:, 1);  % columna 1 = ángulo
pwm_sim    = datos_sim(:, 2);  % columna 2 = PWM
error_sim  = datos_sim(:, 3);  % columna 3 = error

% === Redondear para mejor visualización ===
tiempo_sim = round(tiempo_sim, 2);
angulo_sim = round(angulo_sim, 2);




% Si tus vectores no están en celdas, conviértelos ahora:
if ~iscell(tiempo)
    tiempo = {tiempo};
    angulo = {angulo};
    error  = {error};
    pwm    = {pwm};
    n_experimentos = 1;
end

% === Graficar comparación ÁNGULO ===
figure('Name','Comparación: Ángulo Real vs Simulado','Units','normalized','Position',[0.1 0.4 0.8 0.45]);
hold on; grid on;

plot(tiempo_sim, angulo_sim, 'k--', 'LineWidth', 2);

colores = lines(n_experimentos);
for i = 1:n_experimentos
    plot(tiempo{i}, angulo{i}, '-', 'Color', colores(i,:), 'LineWidth', 1.5);
end

xlabel('Tiempo (s)');
ylabel('Ángulo (°)');
title('Comparación respuesta en malla cerrada simulación y realidad');
legend_labels = ["Simulación"];
for i = 1:n_experimentos
    legend_labels(end+1) = sprintf('Experimento %d', i);
end
legend(legend_labels, 'Location', 'best');

% === Graficar PWM y Error incluyendo Simulación ===
figure('Name','PWM y Error: Simulación vs Experimentos','Units','normalized','Position',[0.1 0.05 0.8 0.35]);

subplot(1,2,1); hold on; grid on;
title('PWM aplicado'); xlabel('Tiempo (s)'); ylabel('PWM [\mus]');
plot(tiempo_sim, pwm_sim, 'k--', 'LineWidth', 2, 'DisplayName', 'Simulación');
for i = 1:n_experimentos
    plot(tiempo{i}, pwm{i}, '-', 'Color', colores(i,:), 'LineWidth', 1.3, 'DisplayName', sprintf('Experimento %d', i));
end
legend('Location', 'best');

subplot(1,2,2); hold on; grid on;
title('Error de control'); xlabel('Tiempo (s)'); ylabel('Error (rad)');
plot(tiempo_sim, error_sim, 'k--', 'LineWidth', 2, 'DisplayName', 'Simulación');
for i = 1:n_experimentos
    plot(tiempo{i}, error{i}, '-', 'Color', colores(i,:), 'LineWidth', 1.3, 'DisplayName', sprintf('Experimento %d', i));
end
legend('Location', 'best');
